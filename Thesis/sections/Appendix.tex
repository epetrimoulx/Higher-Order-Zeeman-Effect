% FIX GRAPHS NOT APPEARING
\chapter{Derivation of the Recursion Relations}
    The aim of this section is to guide the reader through a more in depth derivation of the recursion relations for the quadratic zeeman effect as well as the magnetic dipole operator perturbations to the Hamiltonian. Starting with the first order perturbation equation

    \begin{align}
        \left(H^0 - E^0 \right) \vert \psi^1 \rangle = \left( V + E^1  \right) \vert \psi^0 \rangle\;,
    \end{align}

    \noindent $E^1$ can be found by multiplying through by $\langle \psi^0 \vert$
    \begin{align}
        \langle \psi^0 \vert H^0 - E^0 \vert \psi^1 \rangle &= \langle \psi^0 \vert V + E^1 \vert \psi^0 \rangle \;.
    \end{align}
    \noindent The first term is $0$ due to the orthogonality of states which is imposed and discussed in Sec.~\ref{sec:Zeeman-Effect}. The expression now reads 

    \begin{align}
        &\langle \psi^0 \vert V - E^1 \vert \psi^0 \rangle = 0 \\
        &\langle \psi^0 \vert V \vert \psi^0 \rangle =  \langle \psi^0 \vert E^1 \vert \psi^0 \rangle\\
        &\langle \psi^0 \vert V \vert \psi^0 \rangle =  E^1 \langle \psi^0 \vert \psi^0 \rangle
    \end{align}

    \noindent So 

    \begin{align}
        E^1 = \langle \psi^0 \vert V \vert \psi^0 \rangle\;.
    \end{align}

    \noindent For the $r^2$ perturbation, one gets 

    \begin{align}
        E^1 &= \int^\infty_0\int_0^\pi  \int_0^{2\pi} r^2 \sin\theta \frac{2Z^{\frac{3}{2}} e^{-Zr}}{\sqrt{4\pi}} \; \frac{B^2e^2}{8m}r^2\;  \frac{2Z^{\frac{3}{2}} e^{-Zr}}{\sqrt{4\pi}} \;dr\; d\theta\; d\phi\\ \nonumber\\
        E^1 &= {4\pi} \int_0^\infty \frac{Z^3 e^{-2Zr}}{\pi} \; \frac{B^2e^2}{8m}r^4 \;dr\\ \nonumber\\
        E^1 &= \frac{Z^3 B^2 e^2}{2m} \frac{4!}{(2Z)^5} \\ \nonumber \\
        E^1 &= \frac{3 B^2 e^2}{8Z^2m}
    \end{align}

    \noindent Here, we let $\frac{B^2 e^2}{m} \equiv \gamma^2$, similarly to \cite{Killingbeck_1979}, and we end up with the final result for $E^1$ to be 

    \begin{align}
        \frac{1}{8} \gamma^2 \frac{3}{Z^2}\;.
    \end{align}

    \noindent The perturbing potential $V$ also is written in terms of $\gamma^2$
    \begin{align}
        V = \frac{B^2 e^2}{8m} r^2 = \frac{1}{8} \gamma^2 r^2
    \end{align}

    \noindent Assuming that $\vert \psi^1 \rangle$ is of the form of a power series 
    \begin{align}
        \vert \psi^1 \rangle = \sum_{j = 0}^\infty Z^{\frac{3}{2}} a_j r^j e^{-Zr}
    \end{align}
    \noindent and substituting both $E^1$ and $\vert \psi^1 \rangle$ into the perturbation equation we get 

    \begin{align}
        \left(H^0 - E^0 \right) \sum_{j = 0}^\infty Z^{\frac{3}{2}} a_j r^j e^{-Zr} = \left( \frac{1}{8} \gamma r^2 + \frac{1}{8} \gamma \frac{3}{Z^2} \right) \frac{Z^{\frac{3}{2}} e^{-Zr}}{\sqrt{\pi}}\;.
    \end{align}

    Substituting the Hamiltonian in atomic units 

    \begin{align}
        \left(\frac{1}{2}\nabla^2 + \frac{Z}{r} - E_0\right) \sum_{j = 0}^\infty a_j r^j e^{-Zr} = \left(\frac{1}{8} \gamma r^2 + \frac{1}{8} \gamma \frac{3}{Z^2} \right) \frac{e^{-Zr}}{\sqrt{\pi}}
    \end{align}
    \begin{align}
        \frac{1}{2} \frac{1}{r^2} \frac{\partial}{\partial r} \left(r^2 \frac{\partial}{\partial r} \right) \sum_{j = 0}^\infty a_j r^j e^{-Zr} + Z \sum_{j = 0}^\infty a_j r^{j - 1} e^{-Zr} - E^0 \sum_{j = 0}^\infty a_j r^j e^{-Zr} \nonumber\\ = \left(\frac{1}{8} \gamma r^2 + \frac{1}{8} \gamma \frac{3}{Z^2} \right) \frac{e^{-Zr}}{\sqrt{\pi}}\;.
    \end{align}
    \begin{align}
        \left( \frac{Z^2}{2} - E^0\right) \sum_{j = 0}^\infty a_j r^j - Zr \sum_{j = 0}^\infty a_j r^{j -2} (j + 1) + \sum_{j = 0}^\infty \frac{j(j+1)}{2} a_j r^{j - 2} \nonumber\\+ Z \sum_{j = 0}^\infty a_j r^{j -1} - E^0 \sum_{j = 0}^\infty a_j r^j = \left(\frac{1}{8} \gamma r^2 + \frac{1}{8} \gamma \frac{3}{Z^2} \right)
    \end{align}

    \noindent Since $E^0 = \frac{Z^2}{2}$, the first term is zero and the equation becomes 

    \begin{align}
        -Zr \sum_{j = 0}^\infty a_j r^{j - 2} (j + 1)  \dots \dtos \dtots
    \end{align}



\chapter{Left-acting Operators} \label{sec:Hermitian_Left}
    This section contains the proof for the ability of hermitian operators to act to the left as well as to the right. The specific case discussed here uses the Hamiltonian, but this can be similarly shown for any hermitian operator. Given the matrix element
    \begin{align}
        \langle \psi \vert \hat{H} \vert \phi \rangle &= \int^\infty_{-\infty} \psi^*(x) \hat{H} \phi(x) dx\\
        \langle \psi \vert \hat{H} \vert \phi \rangle &= \int^\infty_{-\infty} \psi^*(x) -i\hbar\frac{d \phi(x)}{dx} dx\;,
    \end{align}

    \noindent applying integration by parts gives 

    \begin{align}
        \langle \psi \vert \hat{H} \vert \phi \rangle &= \left[\psi^*(x) \phi(x) \right]^\infty_{-\infty} - \int_{-\infty}^\infty -i\hbar \frac{d\psi^*(x)}{dx} \phi(x) dx\\
        \langle \psi \vert \hat{H} \vert \phi \rangle &= \int_{-\infty}^\infty i\hbar \frac{d\psi^*(x)}{dx} \phi(x) dx\;.
    \end{align}

    \noindent Which is the same as writing

    \begin{align}
        \langle \psi \vert \hat{H} \vert \phi \rangle = \int^\infty_{-\infty} \phi(x) \hat{H} \psi^*(x) dx
    \end{align}

    \noindent So it is shown that the Hamiltonian is capable of acting to the right or to the left, and it is up to the user which way they want to apply the operation.
\chapter{Special Functions}
    \section{Overview}
        This section of the appendix discusses the special functions used throughout this thesis, providing their definitions and properties in greater detail than discussed in the main body of this paper. The introduction to these functions is brief, and are placed here for convenience of the reader. Sec~.\ref{sec:Gamma_Function} introduces the gamma function and its properties, and its use in providing a closed solution to many of the integrals present in the matrix elements discussed in Sec~.\ref{sec:Integration_Techniques} is highlighted. Sections \ref{sec:Laguerre_Polynomial} and \ref{sec:Spherical_Harmonics} introduce the Laguerre polynomials and the spherical harmonic function respectively, which are key to the solution of hydrogenic wavefunctions used in this thesis. Additionally, the confluent hypergeometric function is discussed in Sec~.\ref{sec:Confluent_Hypergeometric_Function}, where an alternative formulation of the radial wavefunctions for hydrogen is given. Finally, the chapter concludes with the description of Legendre polynomials, which can be used in a similar manner to the spherical harmonics due to their property of forming a complete set of orthogonal functions.
    \section{The gamma function} \label{sec:Gamma_Function}
        The gamma function $\Gamma(z)$ is an extension of the factorial function into the complex plane. 
        \begin{align}
            \Gamma(z) \in \mathbb{C} 
        \end{align}
        For the case where the input parameter $z \in \mathbb{Z}^+$, the function is equal to \cite{Arfken_Weber_Arfken_Weber_2008}
        \begin{align}
            \Gamma(n) = (n - 1)!\;.
        \end{align}

        \noindent This is a relation of key importance in Sec.~\ref{sec:The_Radial_Part}, where the radial integral is replaced with a factorial function for positive integers of $j$ in the sum.\\

        The gamma function also has an integral definition, which is known as the Euler integral

        \begin{align}
            \Gamma(z) = \int_0^\infty e^{-t} t^{z-1} dt, \hspace{1cm} \mathfrak{R}e(z) > 0\;.
        \end{align}

        \noindent This integral is defined as long as the real part of $z$ is greater than zero. This integral closely resembles the radial integrals present in Sec.~\ref{sec:The_Radial_Part}, which are of the form

        \begin{align}
            I_{\text{radial}} = \int_0^\infty r^j e^{-\alpha r} dr
        \end{align}

        \noindent To fit the gamma function, perform a change of variables $t = \alpha r$, $dt = \alpha dr$.

        \begin{align}
            I_{\text{radial}} &= \int_0^\infty \left( \frac{t}{\alpha} \right)^j e^{-t} \frac{1}{\alpha} dt
        \end{align}
        %
        \begin{align}
            I_{\text{radial}} &= \frac{1}{\alpha^{j+1}}\int_0^\infty {t}^j e^{-t} dt
        \end{align}

        \noindent So the solution to the radial integral is shown to be 

        \begin{align}
            I_{\text{radial}} = \frac{\Gamma(j+1)}{\alpha^{j+1}}
        \end{align}

        \noindent if $j \in \mathbb{Z}^+$, the relationship between the gamma function and the factorial function can be used. The values of $j$ are the summation indices for each power of $r$\footnote{See sections \ref{sec:quadratic_zeeman} and \ref{sec:magnetic_dipole_operator} for the summation expressions for each.}. Since the summation indices are constrained to a set of integers from 0 to infinity, it can be said that 

        \begin{align}
            \forall j, j \in Z^{0+}
        \end{align}

        \noindent Additionally, the $0^{\text{th}}$ power of $r$ (corresponding to $j = 0$) does not appear in the recursion relations of the expanded sum in \ref{sec:magnetic_dipole_operator}, and is zero in \ref{sec:quadratic_zeeman}. This further restricts the set of $j$ indices in both problems to 

        \begin{align}
            \forall j, j\in \mathbb{N}
        \end{align}

        \noindent Since the set of natural numbers only contains positive integers, the euler integral only evaluates values for positive integer $j$. The gamma function by its original definition is then replaced by the factorial function, giving the solution to the radial integrals used in sections \ref{sec:The_Radial_Part}, \ref{sec:quadratic_zeeman} and \ref{sec:magnetic_dipole_operator}. 

        \begin{figure}[ht!]
            \centering
            \resizebox{0.8\linewidth}{!}{\input{Gamma_function.pgf}}
            \caption{Graph of the gamma function compared to the factorial function.}
            \label{img:Gamma_fn_graph}
        \end{figure}

    \section{Legendre Polynomials} \label{sec:Legendre_Polynomial}
        The Legendre equation is 
        \begin{align}
            (1 - x^2)P^{\prime \prime}(x) -2xP^\prime(x) + \lambda P(x) = 0\;.
        \end{align}

        \noindent This differential equation can be solved with a series solution about $x = 0$ and has a radius of convergence of 1. If $\lambda$ has the value $l(l+1)$, where $l \in \mathbb{Z}$, the series truncates after $x^{l}$. The series solution to this ODE is 

        \begin{align}
            g(x, t) = \sum_{l = 0}^\infty P_l(x) t^l 
        \end{align}

        \noindent Where $g(x, t)$ is the generating function which produces the possible solutions to the Legendre Equation. Each solution to the Legendre equation generated by $g(x, t)$ is called a Legendre polynomial. These polynomials can be produced with the following equation

        \begin{align}
            P_l(x) = \sum_{n = 0}^{\lfloor \frac{l}{2} \rfloor} (-1)^k \frac{(2l - 2k)!}{2^n k! (n - k)!(n - 2k)!}x^{n-2k}
        \end{align}

        \noindent where $\lfloor x \rfloor$ is the floor function, which rounds down to the nearest integer value. This formulation is of key importance for programmed implementation, since a discrete formula is simple to compute. A more helpful definition of the Legendre polynomial comes from the Rodriguez formula \cite{Arfken_Weber_Arfken_Weber_2008}

        \begin{align}
            P_n(x) = \frac{1}{2^n n!} \left( \frac{d}{dx} \right)^n (x^2 - 1)^n
        \end{align}

        \noindent This formulation is much more useful for analytical work. The first few Legendre Polynomials are given below

        \begin{figure}
            \centering
            \begin{tabular}{l}
                Legendre Polynomials\\
                \hline
                $P_0(x) = 1$\\
                $P_1(x) = x$\\
                $P_2(x) = \frac{1}{2}\left(3x^2 - 1\right)$\\
                $P_3(x) = \frac{1}{2} \left(5x^3 - 3x\right)$ \\
                $P_4(x) = \frac{1}{8} \left(35x^4 - 30x^2 + 3 \right)$\\
                \hline
            \end{tabular}
            \caption{Table of the first few Legendre Polynomials}
            \label{tab:Legendre_Polynomials}
        \end{figure}

        \noindent Another key feature of the Legendre polynomials is that they form a complete set of orthogonal basis functions, meaning that for each value of $l$, the associated Legendre polynomial is orthogonal to all other Legendre polynomials with different $l$.

        \begin{align}
            \int_{-1}^1 P_l(x) P_l^\prime(x) = \frac{2}{2l + 1}\delta_{l,l^\prime}
        \end{align}

        \begin{figure}[ht!]
            \centering
            \resizebox{0.8\linewidth}{!}{\input{Legendre_polynomials.pgf}}
            \caption{Graph of the first few Legendre polynomials}
            \label{img:Legendre_polynomials}
        \end{figure}

        \noindent The Legendre polynomials appear in the angular part of the solution to hydrogenic wavefunctions as discussed in Sec.~\ref{sec:The_Angular_Part}. They are also incorporated into the spherical harmonic function discussed in Sec.~\ref{sec:Spherical_Harmonics}.

        \section{Laguerre Polynomials} \label{sec:Laguerre_Polynomial}
        The Laguerre ODE is 

        \begin{align}
            xy^{\prime \prime}(x) + (1 - x)y^\prime(x) + ny(x) = 0 
        \end{align}


        \begin{figure}[h]
            \centering
            \resizebox{0.8\linewidth}{!}{\input{Laguerre_polynomials.pgf}}
            \caption{Graph of the first few Laguerre polynomials}
            \label{img:Laguerre_polynomials}
        \end{figure}

        \noindent which has unique solutions which are known as Laguerre polynomials. These polynomials can be generated given the following formula 

        \begin{align}
            L_n(x) = \frac{e^x}{n!} \left( \frac{d}{dx} \right)^n (x^ne^{-x})\;.
        \end{align}

        \noindent Where the generating function $g(x, t)$ is given by \cite{Arfken_Weber_Arfken_Weber_2008}

        \begin{align}
            g(x, t) = \frac{e^x}{2\pi i} \oint_C \frac{e^{-z}}{z - x - tz} dz = \frac{e^{\frac{-xt}{(1 - t)}}}{1 - t} = \sum_{n = 0}^\infty L_n(x) t^n
        \end{align}

        \begin{figure}
            \centering 
            \begin{tabular}{l}
                Laguerre polynomials\\
                \hline 
                $L_0(x) = 1$\\
                $L_1(x) = -x + 1$\\
                $L_2(x) = \frac{x^2 - 4x + 2}{2!}$\\
                $L_3(x) = \frac{x^3 + 9x^2 - 18x + 6}{3!}$\\
                $L_4(x) = \frac{x^4 - 16x^3 + 72x^2 - 96x + 24}{4!}$\\
                \hline
            \end{tabular}
        \end{figure}

        \noindent Similarly to the Legendre polynomials and spherical harmonic functions, the Laguerre polynomials also form a complete set of orthogonal basis functions.

        \begin{align}
            \int_0^\infty L_n(x) L_m(x) e^{-x} dx = \delta_{m n}
        \end{align}

        \noindent The Laguerre polynomials are used to described the radial part of the solution to hydrogenic wavefunctions, as discussed in Sec.~\ref{sec:The_Radial_Part}. 
        \section{Spherical Harmonics} \label{sec:Spherical_Harmonics}
        Spherical harmonics appear most commonly when solving Laplace's equations in spherical coordinates. It is composed of the Legendre polynomials with an additional phase about the azimuthal angle $\phi$ \cite{Riley_Hobson_Bence_2006}. Laplace's equation is 

        \begin{align}
            \nabla^2 f(r, \theta, \phi) = 0
        \end{align}

        \noindent The solution to this equation is separable, so the angular part of the solution can be written as a product of two functions 

        \begin{align}
            \Theta (\theta) \Phi(\phi) = P^m_l(\cos(\theta)) e^{im\phi}\;.
        \end{align}

        \noindent The product of these two angular functions is called the spherical harmonic function, it is denoted by 

        \begin{align}
            Y^m_l (\theta, \phi) = P^m_l(\cos(\theta)) e^{im\phi}\;.
        \end{align}

        \noindent Where $P^l_m(\cos \theta)$ is the associated Legendre polynomial, which is related to the standard Legendre polynomial by 

        \begin{align}
            P^m_l(x) = (-1)^m (1-x^2)^{\frac{m}{2}} \frac{d^m}{dx^m} \left(P_l(x) \right)
        \end{align}

        The spherical harmonic functions for a complete set of orthogonal basis functions 

        \begin{align}
            \int_0^{2\pi} \int_0^\pi Y^m_l(\theta, \phi) Y^{m^\prime}_{l^\prime}(\theta, \phi) d\theta d\phi = \delta_{ll^\prime}\delta_{mm^\prime}
        \end{align}

        \begin{figure}[h]
            \centering 
            \resizebox{\columnwidth}{!}{
                \begin{tabular}{l l l}
                    Spherical harmonic functions&\\
                    \hline 
                    $Y^0_0 (\theta, \phi) = \sqrt{\frac{1}{4\pi}}$ & & \\
                    $Y^0_1 (\theta, \phi_) = \sqrt{\frac{3}{4\pi}} \cos \theta$ & $Y^{\pm1}_{1} (\theta, \phi) = \mp \sqrt{\frac{3}{8\pi}} \sin \theta e^{\pm i \phi}$ &\\
                    $Y^0_2 (\theta, \phi) = \sqrt{\frac{5}{16\pi}} (3 \cos^2\theta - 1)$ & $Y^{\pm 1}_2 (\theta, \phi) = \mp \sqrt{\frac{15}{8\pi}} \sin\theta \cos\theta e^{\pm i\phi}$ & $Y^{\pm 2}_2(\theta, \phi) = \sqrt{\frac{15}{32\pi}} \sin^2 \theta e^{\pm2i\phi}$\\
                    \hline
                \end{tabular}
            }
            \caption{Table of the first few spherical harmonic functions}
            \label{tab:spherical_harmonic}
        \end{figure}

        \noindent The spherical harmonic functions play a key role in the solution to the angular part of the hydrogenic wavefunctions in the derivation of the quadratic Zeeman effect and the magnetic dipole moment operator.

        \section{Confluent Hypergeometric Function} \label{sec:Confluent_Hypergeometric_Function}
        The confluent hypergeometric function is a special form of the standard hypergeometric function. The confluent hypergeometric functions are produced from the solution to the differential equation 

        \begin{align}
            xy^{\prime \prime} + (c - x)y^\prime - ay = 0
        \end{align}

        \noindent where there are two possible solutions 

        \begin{align}
            y_1(x) &= 1 + \frac{a}{c} \frac{x}{1!} + \frac{a(a+1)}{c(c+1)}\frac{x^2}{2!} + \dots \equiv M(a, c ;x)\\
            y_2(x) &= x^{1-c}M(a-c + 1, 2 - c; x)\;.
        \end{align}

        \noindent The function $M(a, c;x)$ is called the confluent hypergeometric function \cite{Riley_Hobson_Bence_2006}. It can also be described by the following integral 

        \begin{align}
            M(a, c; x) = \frac{\Gamma(c)}{\Gamma(a)\Gamma(c - a)} \int_0^1 e^{tx} t^{a-1} (1 - t)^{c - a - 1} dt,
        \end{align}

        \noindent which converges so long that $c > a > 0$. The confluent hypergeometric function is a more generalized version of many of the special functions discussed in this chapter, and depending on the choice of $a$ and $c$, are capable of producing the other special functions. For example, the Laguerre polynomials can be expressed in terms of the confluent hypergeometric function as 

        \begin{align}
            M(a, b; x) = \frac{\Gamma(1 - a) \Gamma(b)}{\Gamma(b - a)} L_a^{b-1}(x)\;. \label{eq:confluent-hypergeometric}
        \end{align}

        \noindent $L_a^{b-1}(x)$ is known as the associated Laguerre polynomial, and is related to the standard Laguerre polynomial discussed in Sec.~\ref{sec:Laguerre_Polynomial} by 
        \begin{align}
            L_n^k(x) = (-1)^k \frac{d^k}{dx^k} L_{n+k}(x)\;.
        \end{align}

        \noindent In the relation given in equation \eqref{eq:confluent-hypergeometric}, $k = {b-1}$, and $n = a$. The confluent hypergeometric function is used to represent the radial solutions to the hydrogenic wavefunctions discussed in sections \ref{sec:quadratic_zeeman} and \ref{sec:magnetic_dipole_operator}.


\chapter{Methods of solving for higher-order perturbations programmatically} \label{sec:Program_perturbation}
    This section serves as a reference to the codes implemented to solve higher order perturbations for the quadratic Zeeman effect and the magnetic dipole moment operator. The codes can be found on the authors GitHub page at \href{https://github.com/epetrimoulx/Quadratic-Zeeman-Effect}{epetrimoulx/Higher-Order-Zeeman-Effect}. The code is designed such that the order of the perturbation being considered is decided by the user. The first and second order perturbation equations look like 

    \begin{align}
        \left( H^0 - E^0 \right) \vert \psi^{1}\rangle &= \left( V - E^{1}\right) \vert \psi^{0} \rangle \\
        \left( H^0 - E^0 \right) \vert \psi^{2}\rangle &= V \vert \psi^{1}\rangle + E^{1} \vert \psi^{1} \rangle + E^{2} \vert \psi^{0} \rangle
    \end{align}

    \noindent The second order perturbation equation is dependant on the answer for $\vert \psi^{(1)} \rangle$ from the first order perturbation equation. However, if the second order solution is expressed in terms of the first order solution

    \begin{align}
        \left( H^0 - E^0 \right) \vert \psi^{2}\rangle &= \left(V - E^{1}\right) (H^0 - E^0)^{-1} E^{(1)} |\psi^{(0)}\rangle + E^{2} |\psi^{0}\rangle\;.
    \end{align}

    \noindent This can be treated as just solving the first order equation again but with a modified inhomogeneous term on the RHS of the equation. 
    
    \begin{align}
        \left( H^0 - E^0 \right) \vert \psi^{n} \rangle &= F(V, \psi^{n-1}) + E^{n} \vert \psi^{0} \rangle\;.
    \end{align}

    \noindent This ``folding'' of the perturbation equation at higher order onto itself using the previous solutions from the lower order equations allows for the iterative calculation of higher order perturbations. The main issue with this strategy is that the equations become too long for any human to do by hand, but computationally, this can be calculated to $n^\text{th}$ order easily so long that the user carefully accounts for higher order contributing states such as the $d$-states which arise in second order perturbations of $r^2$. 

